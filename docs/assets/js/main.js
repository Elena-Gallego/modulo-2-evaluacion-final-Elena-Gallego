"use strict";const dataList=document.querySelector(".js-data-list"),favouriteList=document.querySelector(".js-favourite-list");let favourites=[];function resetFavourites(e){for(let e=0;e<favourites.length;e++){const t=favourites[e].id,o=document.getElementById(""+t);o&&o.classList.remove("favourite-styles")}favourites=[],reloadFavouriteList(),localStorage.setItem("key-favourites",JSON.stringify(favourites))}function removeFavouriteItem(e){const t=e.currentTarget.parentElement.parentElement,o=t.querySelector("h2").innerHTML,i=favourites.findIndex(e=>e.name===o);if(console.log(i),-1!==i){const e=favourites[i].id,t=document.getElementById(""+e);t&&t.classList.remove("favourite-styles"),favourites.splice(i,1)}favouriteList.removeChild(t),localStorage.setItem("key-favourites",JSON.stringify(favourites))}function reloadFavouriteList(){if(favouriteList.innerHTML="",console.log(favouriteList),favourites.length>0){favouriteList.innerHTML="Tus favoritas";const e=document.createElement("li"),t=document.createElement("button");t.type="button",t.innerHTML="Reset All",t.classList.add("reset-button"),e.appendChild(t),favouriteList.appendChild(e),t.addEventListener("click",resetFavourites)}for(let e=0;e<favourites.length;e++){const t=document.createElement("li"),o=document.createElement("img");o.src=favourites[e].image,t.appendChild(o);const i=document.createElement("h2");i.innerHTML=favourites[e].name,t.appendChild(i);const s=document.createElement("button");s.classList.add("x-button"),s.type="button",s.innerHTML="X",i.appendChild(s),s.addEventListener("click",removeFavouriteItem),favouriteList.appendChild(t)}console.log(favouriteList)}function selectFavourite(e){e.currentTarget.classList.toggle("favourite-styles");const t=e.currentTarget.querySelector("h2").innerHTML,o=e.currentTarget.querySelector("img").src,i=e.currentTarget.getAttribute("id"),s=favourites.findIndex(e=>e.name===t);if(console.log(s),-1===s){const e={name:t,image:o,id:i};favourites.push(e),console.log(favourites)}else favourites.splice(s,1);reloadFavouriteList(favourites),localStorage.setItem("key-favourites",JSON.stringify(favourites))}function getListData(e){const t=document.querySelector(".js-input-text").value;fetch("http://api.tvmaze.com/search/shows?q="+t).then(e=>e.json()).then(e=>{dataList.innerHTML="Hemos encontrado esto:";for(let t=0;t<e.length;t++){const o=document.createElement("li");o.setAttribute("id",e[t].show.id);const i=document.createElement("img");e[t].show.image?i.src=e[t].show.image.medium:i.src="https://via.placeholder.com/210x295/ffffff/666666/?text=NO-IMAGE.",o.appendChild(i);const s=document.createElement("h2");s.innerHTML=e[t].show.name,o.appendChild(s),dataList.appendChild(o),o.addEventListener("click",selectFavourite)}})}const buttonSearch=document.querySelector(".js-button-search");buttonSearch.addEventListener("click",getListData);const savedFavourites=JSON.parse(localStorage.getItem("key-favourites"));savedFavourites&&savedFavourites.length>0&&(favourites=savedFavourites,reloadFavouriteList());